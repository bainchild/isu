local a=typeof or type;local b=coroutine.running;local c=Instance.new;local pairs=pairs;local d=setmetatable;local e=game:GetService("TweenService")local f={}local g={}local function h(i)return d({v=i},{__mode='v'})end;local function j(k,l)local m={}for n,o in pairs(k)do local p,q=n,o;if a(n)=='table'and l then p=j(n,l)end;if a(o)=='table'and l then q=j(o,l)end;m[p]=q end;return m end;local function r()local s={stack={},coro=d({},{__mode='v'})}function s:at(t)return self.stack[t]end;function s:write(t,i)self.stack[t]=i end;function s:push(i)self.stack[#self.stack+1]=i;return i end;function s:reset()self.coro[b()]=0 end;function s:next()local u=b()self.coro[u]=self.coro[u]+1;return self:at(self.coro[u]),self.coro[u]end;return s end;local function v(w,x)x=x or b()g[x]=w;return g[x]end;local function y(x)x=x or b()return g[x]end;local function z(A,B,...)local C=y()v(A)local D=B(...)v(C)return D end;local E;do local function F(G,H)local I=c(G)for n,o in pairs(H)do if a(n)=='number'then o().Parent=I else I[n]=o end end;return I end;function E(G,H)local A=y()local J=A.objects:next()H=H or{}if not J then J=F(G,H)A.objects:push(J)J.Destroying:Connect(function()for K,L in pairs(A.unmounts.stack)do L()end end)end;for K,M in pairs(A.events.stack)do M.connection=J[M.name]:Connect(M.fn)end;return J end end;local function N(O,P,Q,R)local S;local function T(U)S=U end;local V=e:Create(O,TweenInfo.new(R.fn(Q,T)),{[P]=Q})if S then V.Completed:Connect(S)end;V:Play()return true end;local function W(X,Y)local A=y()for n,o in pairs(Y)do if a(n)~='number'then local Z,_=a(X[n]),a(o)if Z~=_ then X[n]=o elseif X[n]~=o then local a0={}for K,a1 in pairs(A.transitions.stack)do if a1.name==n then a0[n]=N(X,n,o,a1)end end;if not a0[n]then X[n]=o end end else o()end end;return X end;function f.useState(i)local A=y()local J,t=A.states:next()if J then return J.value,J.updater else local a2;a2=A.states:push({value=i,updater=function(a3)if A.states:at(t).value~=a3 then a2.value=a3;A.render()end end})return a2.value,a2.updater end end;function f.useEffect(B,a4)local A=y()local J=A.effects:next()if not J then A.effects:push(true)local L=B()if L and not A.unmounts:next()then A.unmounts:push(L)end end end;function f.useEvent(a5,a6)local A=y()local J=A.events:next()if not J then A.events:push({name=a5,fn=a6})else J.connection:Disconnect()J.connection=nil;J.fn=a6 end end;function f.useTransition(a7,a8)local A=y()local J=A.transitions:next()if not J then A.transitions:push({name=a7,fn=a8})end end;function f.component(a9)return function(aa)local ab={}if y()then local ac=y()local J=ac.subcomponents:next()if J then J.props=aa;return J.render else ac.subcomponents:push(ab)end end;ab.prev=h(nil)ab.props=aa;ab.objects=r()ab.states=r()ab.effects=r()ab.unmounts=r()ab.events=r()ab.transitions=r()ab.subcomponents=r()ab.render=function()return coroutine.wrap(function()return z(ab,function()ab.objects:reset()ab.states:reset()ab.effects:reset()ab.unmounts:reset()ab.events:reset()ab.transitions:reset()ab.subcomponents:reset()local G,ad=a9(ab.props)if a(G)~='string'or a(ad)~='table'then error('Component renderer must return a classname and properties.')end;local I=E(G,ad)if not ab.prev.v then ab.prev.v=I else W(ab.prev.v,ad)end;return I end)end)()end;return ab.render end end;return f